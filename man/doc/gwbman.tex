\documentclass[12pt]{article}

\usepackage{ucs}
\usepackage[utf8x]{inputenc} 		% Включаем поддержку UTF8
\usepackage[russian]{babel}  		% Включаем пакет для поддержки русского языка

\usepackage[
	left=2cm, 			% Поле левое : 200 мм
	right=2cm, 			% Поле правое : 200 мм
	top=2cm,			% Поле верхнее: 200 мм
	bottom=2cm,			% Поле нижнее : 200 мм
	bindingoffset=0cm]{geometry}

\usepackage[pdftex]{graphicx, color}
\usepackage{color}
\usepackage{tikz}
\usepackage{url}			% использование URL в библиографии
\usepackage{listings}			% использование листингов кода
\usepackage[nooneline]{caption} 
\captionsetup[table]{justification=raggedleft} 
\captionsetup[figure]{justification=centering,labelsep=endash}
\usepackage{array}

\usepackage{caption}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{cases}

\renewcommand{\baselinestretch}{1.5}

% вставка листингов с кодом
\lstset{inputencoding=utf8x,
		extendedchars=false,
		keepspaces=true,
		language=c}

\renewcommand{\lstlistingname}{Листинг}

%\usepackage{amsmath}
%\usepackage{mathtools}
\setcounter{tocdepth}{4} 	% chapter, section, subsection, subsubsection и paragraph
\setcounter{secnumdepth}{4}

\parindent=1,25cm				% красная строка = 1 см
\usepackage{enumitem}
\setlist[enumerate,1]{leftmargin=2.25cm}
\setlist[itemize]{leftmargin=2.25cm}
\graphicspath{{pics/}}
\DeclareGraphicsExtensions{{.jpg}}

\begin{document}
	\section{Введение}
	\newpage
	\section{Обзор используемых технологий}	
		\subsection{Среда разработки GW-Basic}
			% Здесь нужно рассказать в общем про среду разработки, дату появления.
			\hspace{\parindent} Среда разработки Microsoft GW-Basic, а также одноименный язык программирования представляют собой платформу для написания программ в императивной нотации. 
			% Что из себя представляет
			Управление средой осуществляется с помощью коммандной строки, в которую попадает пользователь после запуска.
			\subsubsection{Cинтаксические конструкции}
			\label{subsec:basicKeywords}
			% Commands, Statements, Variables, Expressions, ...
			% 2.4 Ingleese	
			\hspace{\parindent} Программа на GW-Basic может включать в себя следующие синтаксические конструкции \cite{basicManual}:
			\begin{itemize}
				\item {\bf Ключевые слова} (англ. {\it Keywords}) -- представляют собой зарезервированные слова среды исполнения GW-Basic, и являются частью операторов или комманд. 				
				\item {\bf Комманды} (англ. { \it Commands}) -- это исполняемые инструкции. Выполнение комманд осуществляется сразу после ввода.
				\item {\bf Операторы} (англ. {\it Statements}) -- являются исполняемыми инструкциями программы на GW-Basic. Представляют собой группу ключевых слов, используемых как строки программы среды GW-Basic.
				\item {\bf Функции} (англ. {\it Funtions}) -- по типу возвращаемых значений могут быть: строковыми, численными. 
				\item {\bf Переменные} (англ. {\it Variables}) -- определенная строка, за которой установлено определенное значение. Переменные могут быть объявлены/изменены как пользователем, так и контекстом программы.
			\end{itemize}

			% Про то, что ключевые слова с большой буквы
			\indent Ключевые слова (имена комманд, операторов) представляют собой последовательность заглавных латинских букв. Примерами ключевых слов в GW-Basicявляются слова: {\tt PRINT}, {\tt RETURN}, {\tt GOTO}. Ключевые слова не могут быть использованы в качестве имен переменных, иначе это бы привело к конфликту с такими синтаксическими конструкциями, как {\it Комманды} и {\it Операторы}. \\
			% Подробнее про функции и переменные, про типы значений (строковые и численные) cимвол обязательно должне вначале идти.
			\indent Имена функций и переменных могут включать в себя: буквы латинского алфавита, цифры, символ {\tt '.'}. Также, имена могут начинаться только с латиской буквы.
			
			\indent Список всех синтаксических конструкций представлен в \cite[стр.~117]{basicManual}.
			\subsubsection{Режимы интерпретации запросов}
			\label{subsec:interpTypes}
			% Direct, Indirect
			% 2.5 Line Format
			\hspace{\parindent} Интерпретация пользовательских запросов в среде GW-Basic может проходить в следующих режимах:
			\begin{enumerate}
				\item {\bf Прямой} (англ. {\it Direct}) 
				\item {\bf Непрямой} (англ. {\it Indirect}) 
			\end{enumerate}
			
			\indent В {\it прямом режиме}, введенные операторы и комманды исполняются сразу после окончания ввода. Этот режим используется преимущественно в целях отладки программы, либо для вычисления вычисления выражений, для которых нет необходимости писать программу. \\
			\indent {\it Непрямой режим} используется для создания/редактирования строк программы. Каждая строка программы на GW-Basic имеет следующий формат:
			\begin{center}
				\tt nnnnn statement[statements]
			\end{center}

			\indent	Где {\tt nnnnn} -- номер строки, a {\tt statement} -- оператор GW-Basic. В зависимости от логики программы, строка может содержать более одного оператора ({\tt [statements]}). В этом случае, операторы должны быть разделены символом двоеточия {\tt ':'}. Для запуска программы, используется комманда {\tt RUN}.\\
			\indent Полное руководство по редактированию программы в среде GW-Basic представлено в \cite[стр.~18]{basicManual}.

			\subsubsection{Графический режим}
			% SCREEN 12
			\hspace{\parindent} Согласно \cite[стр.~142]{basicManual}, среда выполнения GW-Basic имеет несколько режимов визуализации информации на экране. Использование комманды {\tt SCREEN} позволяет изменять режим вывода среды с целью включения/отключения/изменения графического режима. По умолчанию, т.е. при запуске среды без использования этой комманды, среда работает в {\it текстовом режиме}, что означает, что выполнение любого оператора, связанного с графикой, будет проигнорировано. \\
			\indent При активации {\it графического режима}, пользователю становится доступно использование графических операторов. Среда GW-Basic предлагает визуализацию следующих примитивов: {\tt CIRCLE}, {\tt LINE}, {\tt POINT}, и т.д. Полный список доступных операторов представлен в \cite[стр.~117]{basicManual}. 
			% страница 142 (Screen) 137 (Circle) 155 (Line)

		\subsection{Flex и Bison -- инструменты разработки анализаторов}
		% описать про flex
		\hspace{\parindent} В процессе развития теории построения компиляторов, сформировалось множество подходов к обработке и анализу программ различных языков программирования. Наиболее популярный из них заключается в разбиении задачи разбора на два этапа \cite[стр.~21]{flexManual}:
		\begin{enumerate}
			\item {\bf Лексический анализ программы} (англ. {\it Scanning}) -- сканирование текста программы с целью выделения {\it токенов} (англ. {\it Tokens}), а также значений, которые стоят за этими токенами.
			\item {\bf Синтаксический разбор} (англ. {\it Parsing}) -- установление связей между токенами, называемых {\it правилами грамматики}. 
		\end{enumerate}
		
		\indent Для выполнения лексического разбора, наиболее популярным генератором анализатора является {\it flex}. В основе выделения токенов лежит использование регулярных выражений. Что касается генерации синтаксического анализатора, то для этих целей широко применяется {\it bison}. Для описания связей между токенами, {\it bison} использует нотацию правил грамматики в форме Бэкус-Наура.	
		\subsection{Glut -- инструментарий для работы с OpenGL}
		% описать про glut
		\hspace{\parindent} {\it Glut} представляет собой оконно-независимый инструмент для написания программ на OpenGL. Инструментарий поддерживает {\it функции обратного вызова} (англ. {\it Callback functions}) для большинства событий \cite{glutCallbacks}. В частности, наиболее используемые функции обратного вызова:
		\begin{itemize}
			\item {\bf glutDisplayFunc} -- вызывается при отрисовке сцены.
			\item {\bf glutReshapeFunc} -- используется для обработки события изменения размера окна.
			\item {\bf glutKeyboardFunc} -- вызывается в случае возникновения нажатия клавиши.
		\end{itemize}
		
	\newpage
	\section{Разработка среды GW-Basic}
		\subsection{Анализаторы языка GW-Basic}
			% какие анализаторы будут разработаны?
			\subsubsection{Лексический анализатор}
			\label{subsec:lexAnalyzer}
				% элементы лексического анализатора (название команд, операторов, ф-ций, ...) (согласно тому, какие могут быть конструкции языка)
				\hspace{\parindent} Рассмотрим основные конструкции, которые необходимо выделить в лексемы:
				\begin{enumerate}
					\item Ключевые слова
					\item Имена функции и переменных.
					\item Константные значения: численные и строковые.
					\item Символы (арифметических операций, операций сравнения, операторы логики).
				\end{enumerate}
				
				\indent Создание переменных или функций, названия которых совпадает с названием ключевых слов недопустимо \cite{basicManual}. Это означает, что приоритет за определением ключевых слов, и что разбор имен функций и переменных должен идти после разбора ключевых слов. Что касается константных значений и символов, то распознавать эти синтаксические конструкции можно на любом этапе.
			\subsubsection{Синтаксический анализатор}
			\label{subsec:syntaxAnalyzer}
				% Основываясь на 1.1 (Ingleese GWBasic), описать что есть Direct/Indirect Mode
				\hspace{\parindent} Целью использования синтаксического анализатора является построение {\it дерева синтаксического разбора} (англ. {\it AST-Tree}). Поскольку среда разработки GW-Basic представляет собой коммандную строку, то синтаксический разбор должен производится для каждого пользоватлеского запроса. Учитывая режимы интерпретации комманд (см. п. \ref{subsec:interpTypes}), сокращенная форма грамматики в нотации Бэкус-Науровой формы, выглядит следующим образом (см. листинг \ref{code:syntaxGrammar}):
				\lstinputlisting[frame=single, basicstyle=\footnotesize, caption={Грамматика синтаксического анализатора языка GW-Basic.}, label={code:syntaxGrammar}]{syntax_grammar.txt}
				
				\indent Грамматика для переменных языка GW-Basic представлена в листинге \ref{code:varGrammar}. Под терминалом {\tt DECLARATION} понимается объявление имени функции или переменной. Символы, следующие за этим терминалом, указывают на тип значения переменной.
				% Конструкции языка (Операторы, выражения, команды). а затем, из чего они состоят
				\lstinputlisting[frame=single, basicstyle=\footnotesize, caption={Грамматика для переменных языка GW-Basic.}, label={code:varGrammar}]{var_grammar.txt}
				
				% Выражения языка GW-Basic
				\indent Для вычисления значений, как с целью вывода результата, так и для определения присваемого значения переменной, необходимо определить грамматику {\it выражений} (англ. {\it Expressions}) (сокращенный вариант, см. листинг \ref{code:exprGrammar}). Поскольку значения переменных могут быть строкового или численного типа, то и выражения могут быть тоже двух типов. 
				\lstinputlisting[frame=single, basicstyle=\footnotesize, caption={Грамматика для выражений языка GW-Basic.}, label={code:exprGrammar}]{expr_grammar.txt}
				

				\indent Для строк, среда GW-Basic предоставляет единственную бинарную операцию -- конкатенацию. В свою очередь, численные выражения разбиваются на четыре класса (см. \cite[стр.~46]{basicManual}):
				\begin{itemize}
					\item {\bf Арифметический оператор} -- выполнение бинарных операций {\tt '+', '-', '\^', '/'}.
					\item {\bf Логический оператор} -- выполнение булевских операций {\tt NOT, AND, OR, XOR}, и т.д. 
					\item {\bf Функциональный оператор} -- математические/строковые функции.
					\item {\bf Оператор отношения} -- выполнение бинарных операций {\tt '>', '<', '=', '<=', '>='}, и т.д.
				\end{itemize}
				% Написать только до момента появляения команд,операторов,фунций
		\subsection{Архитектура системы исполнения}
			\label{subsec:runtimeArch}
			% схема, поэтапная, расширяющаяся
			\hspace{\parindent} Архтектура {\it системы исполнения} (англ. {\it Runtime}) представлена на рис.\ref{fig:runtimeArch}. Компоненты системы исполнения представлены блоками, а зависимость между блоками обозначена стрелочками. 	
			\begin{figure}[h]
				\caption{Архитектура системы исполнения}
				\label{fig:runtimeArch}
			\end{figure}
			
			\indent Рассмотрим компоненты системы исполнения подробнее. 
			
			\subsubsection{Окружение среды}
			\hspace{\parindent} {\it Окружение} (англ. {\it Environment}) включает в себя структуру, которая хранит текущее состояние интерпретатора, а также набор функций для изменения содержимого структуры. Чтобы описать текущее состояние, структура должна содержать следующую информацию:
			\begin{itemize}
				\item Привязку к системе вывода/вывода.
				\item Контекст выполнения.
			\end{itemize}
			% Здесь небольшое расхождение с реализацией... Подразумевается, что контекст содержит все, что может настраивать пользователь: Переменные, строки программы. Также контекст содержит вспомогательную информацию, необходимую для корректного выполнения комманд. (skip_flag для реалзации циклов

			% Парсер, написать со ссылкой на предыдущий раздел
			\subsubsection{Обработка пользовательских запросов}
			% обработчики, и то что для каждой вершины AST дерева, есть соответсвующий обработчик в системе выполнения. 
			\hspace{\parindent} Компонент {\it обработки вершин дерева синтаксического разбора} (англ. {\it AST-Node Handler}) (см. \ref{fig:runtimeArch}), представляет собой набор функций для обработки вершин дерева. Под процессом обработки вершины понимается внесение изменений в {\it контекст исполнения} (см. п. \ref{subsec:runtimeArch}). Так, для каждого типа вершины дерева, существует в точности единственная функция обработки. \\
			\indent Каждая функция обработки, должна иметь следующие входные параметры:
			\begin{itemize}
				\item Окружение системы исполнения.
				\item Вершину дерева синтаксического разбора, тип которой соответствует типу функции.
			\end{itemize}
			
			% связь обработчика вершины с обработкой дочерних узловых вершин	
			\indent Поскольку вершина является элементом дерева, то обработка дочерних вершин осуществляется методом рекурсивного спуска.

			\subsubsection{Выполнение пользовательских запросов}
			% Обработка комманд (сразу после ввода, выполнение всей программы)
			\hspace{\parindent} За выполнение пользовательских комманд отвечает {\it система исполнения} (англ. {\it Runtime}) (см. рис.\ref{fig:runtimeArch}). Согласно п. \ref{subsec:interpTypes}, синтаксис записи комманд влияет на режим выполнения этих комманд средой. В тоже время, режимы выполнения учитываются грамматикой синтаксического анализатора (см. п. \ref{subsec:syntaxAnalyzer}), поэтому реализация {\it прямого} и {\it непрямого} режимов полностью ложится на обработчики соответствующих вершин дерева синтаксического разбора. \\   
			\indent Таким образом, процесс выполнения пользовательского запроса состоит из следующих этапов:
			\begin{enumerate}
				\item Чтение пользовательского запроса.
				\item Применение анализаторов (п. \ref{subsec:lexAnalyzer}, \ref{subsec:syntaxAnalyzer}) c целью построения дерева синтаксического разбора.
				\item Обработка корневого узла дерева с помощью соответствующего обработчика.
			\end{enumerate}
			
			\indent Что касается выполнения программы на GW-Basic, то вся логика выполнения добавленных инструкции содержится в обработчике комманды {\tt RUN}.
			% про то, что в в каждой строке храница вершина AST -- это нужно написать в реализации.
			\subsection{Среда разработки в графическом режиме}
			% картинка с модулями обработки прерываний с клавиатуры
			% выводом данных
			% представлением терминала
			% написать про структуру ide, и что она в себя включает Env системы исполнения (Runtime)
	\newpage
	\section{Реализация среды GWBasic}
		% Реализация среды на C (К вопросу о языке разработки), 
		\subsection{Лексический и синтаксический анализаторы}
			% Использование инструментов Flex и Bison
			% Ссылки на соответствующие пункты разработки + в приложении разместить грамматику
		\subsection{Система исполнения}
			% Описание этих компонентов со ссылкой нареализацию на C.
			% Про обработчики
			% Вывод результата (DisplayDebug, DisplayResult, DisplayCoreValue)
		\subsection{Пользовательский интерфейс}
			% Использование Glut, описать что все элементы 1.3 c точки зрения реализации на Glut
	\newpage
	\section{Тестирование}
		\subsection{Входная программа}
		% Программа со стрельбой по мишени	
	\newpage	
	\section{Заключение}
	\newpage
	\nocite{*}
	\bibliographystyle{plain}		
	\bibliography{biblio}
	
	\newpage
	\tableofcontents %Содержание	
\end{document}
